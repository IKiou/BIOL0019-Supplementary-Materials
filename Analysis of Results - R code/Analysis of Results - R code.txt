# ANALYSIS OF RESULTS - USEFUL COMMANDS# 5.1 - Calculation of distances using Robinson Foulds (uncorrected and weighted)#Reading in the data framesfoldtree_RF_uncorrected <- read.table("foldtree_robinson_foulds_input.nwk_uncorrectedRFMatrix.txt", header = FALSE, skip = 1)foldtree_RF_corrected <- read.table("foldtree_robinson_foulds_input.nwk_weightedRFMatrix.txt", header = FALSE, skip = 1)lddt_RF_uncorrected <- read.table("lddt_robinson_foulds_input.nwk_uncorrectedRFMatrix.txt", header = FALSE, skip = 1)lddt_RF_corrected <- read.table("lddt_robinson_foulds_input.nwk_weightedRFMatrix.txt", header = FALSE, skip = 1)iqtree_treefile_RF_uncorrected <- read.table("iqtree_treefile_robinson_foulds_input.nwk_uncorrectedRFMatrix.txt", header = FALSE, skip = 1)iqtree_treefile_RF_corrected <- read.table("iqtree_treefile_robinson_foulds_input.nwk_weightedRFMatrix.txt", header = FALSE, skip = 1)alntmscore_RF_uncorrected <- read.table("alntmscore_robinson_foulds_input.nwk_uncorrectedRFMatrix.txt", header = FALSE, skip = 1)alntmscore_RF_corrected <- read.table("alntmscore_robinson_foulds_input.nwk_weightedRFMatrix.txt", header = FALSE, skip = 1)iqtree_consensus_RF_uncorrected <- read.table("iqtree_consensus_robinson_foulds_input.nwk_uncorrectedRFMatrix.txt", header = FALSE, skip = 1)iqtree_consensus_RF_corrected <- read.table("iqtree_consensus_robinson_foulds_input.nwk_weightedRFMatrix.txt", header = FALSE, skip = 1)#Histogram for foldtreehist(foldtree_RF_uncorrected$V1, breaks = max(foldtree_RF_uncorrected$V1)/2, col = "red", xlim = c(0,250))abline(v=mean(foldtree_RF_uncorrected$V1), lty = 2)hist(foldtree_RF_corrected$V1, breaks = max(foldtree_RF_corrected$V1)/2, col = adjustcolor("blue", alpha.f = 0.75), add = T) abline(v=mean(foldtree_RF_corrected$V1), lty = 3)#Histogram for lddthist(lddt_RF_uncorrected$V1, breaks = max(lddt_RF_uncorrected$V1)/2, col = "red", xlim = c(0,250))abline(v=mean(lddt_RF_uncorrected$V1), lty = 2)hist(lddt_RF_corrected$V1, breaks = max(lddt_RF_corrected$V1)/2, col = adjustcolor("blue", alpha.f = 0.75), add = T) abline(v=mean(lddt_RF_corrected$V1), lty = 3)#Histogram for iqtree treefilehist(iqtree_treefile_RF_uncorrected$V1, breaks = max(iqtree_treefile_RF_uncorrected$V1)/2, col = "red", xlim = c(0,250))abline(v=mean(iqtree_treefile_RF_uncorrected$V1), lty = 2)hist(iqtree_treefile_RF_corrected$V1, breaks = max(iqtree_treefile_RF_corrected$V1)/2, col = adjustcolor("blue", alpha.f = 0.75), add = T) abline(v=mean(iqtree_treefile_RF_corrected$V1), lty = 3)#Histogram for alntmscorehist(alntmscore_RF_uncorrected$V1, breaks = max(alntmscore_RF_uncorrected$V1)/2, col = "red", xlim = c(0,250))abline(v=mean(alntmscore_RF_uncorrected$V1), lty = 2)hist(alntmscore_RF_corrected$V1, breaks = max(alntmscore_RF_corrected$V1)/2, col = adjustcolor("blue", alpha.f = 0.75), add = T) abline(v=mean(alntmscore_RF_corrected$V1), lty = 3)#Histogram for iqtree consensushist(iqtree_consensus_RF_uncorrected$V1, breaks = max(iqtree_consensus_RF_uncorrected$V1)/2, col = "red", xlim = c(0,250))abline(v=mean(iqtree_consensus_RF_uncorrected$V1), lty = 2)hist(iqtree_consensus_RF_corrected$V1, breaks = max(iqtree_consensus_RF_corrected$V1)/2, col = adjustcolor("blue", alpha.f = 0.75), add = T) abline(v=mean(iqtree_consensus_RF_corrected$V1), lty = 3)#Reading in the phylogenetic treesiqtree_concatenatedTree <- read.tree("iqtree_concatenated.txt.contree")iqtree_consensusTree <- read.tree("iqtree_consensus_astral.tree")iqtree_treefileTree <- read.tree("iqtree_treefile_astral.tree")foldtreeTree <- read.tree("foldtree_astral.tree")lddtTree <- read.tree("lddt_astral.tree")alntmscoreTree <- read.tree("alntmscore_astral.tree")alltrees <- as.multiPhylo(c(iqtree_concatenatedTree, iqtree_consensusTree, iqtree_treefileTree, foldtreeTree, lddtTree, alntmscoreTree))distMat <- multiRF(alltrees)colnames(distMat) <- c("iqtree_concatenatedTree", "iqtree_consensusTree", "iqtree_treefileTree", "foldtreeTree", "lddtTree", "alntmscoreTree")rownames(distMat) <- c("iqtree_concatenatedTree", "iqtree_consensusTree", "iqtree_treefileTree", "foldtreeTree", "lddtTree", "alntmscoreTree")distMat
# 5.2 - Comparing FoldTree and iQtree gene trees distancesfoldtree_trees_analysis <- read.table("foldtree_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)rownames(foldtree_trees_analysis) <- c(1:203)iqtree_treefiles_analysis <- read.table("iqtree_treefiles_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(foldtree_trees_analysis$V1, iqtree_treefiles_analysis$V1,      main = "Distance between accepted Metazoa tree and inferred gene trees",      xlab = "FoldTree gene trees (wRF)",      ylab = "IQ-TREE best ML gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(foldtree_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(foldtree_trees_analysis))#axis(side = c(1,2), at = c(0,50,100,150,200), labels = seq(50,250,50))
cor.test(x = foldtree_trees_analysis$V1, y = iqtree_treefiles_analysis$V1, method = "pearson")#Excluding outliercor.test(x = foldtree_trees_analysis$V1[-c(144)], y = iqtree_treefiles_analysis$V1[-c(144)], method = "pearson")
summary(foldtree_trees_analysis)summary(iqtree_treefiles_analysis)which(foldtree_trees_analysis$V1 == min(foldtree_trees_analysis))phylopruner_species_files <- read.table("phylopypruner_species_files.txt", header = FALSE)which(foldtree_trees_analysis$V1 > iqtree_treefiles_analysis$V1)which(as.integer(foldtree_trees_analysis$V1) == as.integer(iqtree_treefiles_analysis$V1))phylopruner_species_files[18, ]phylopruner_species_files[60, ]phylopruner_species_files[148, ]phylopruner_species_files[192, ]which(iqtree_treefiles_analysis$V1 > foldtree_trees_analysis$V1)phylopruner_species_files[14, ]phylopruner_species_files[31, ]phylopruner_species_files[35, ]phylopruner_species_files[42, ]phylopruner_species_files[48, ]phylopruner_species_files[50, ]phylopruner_species_files[56, ]phylopruner_species_files[71, ]phylopruner_species_files[81, ]phylopruner_species_files[106, ]phylopruner_species_files[113, ]phylopruner_species_files[122, ]phylopruner_species_files[129, ]phylopruner_species_files[168, ]phylopruner_species_files[189, ]phylopruner_species_files[203, ]which(foldtree_trees_analysis$V1 == max(foldtree_trees_analysis))phylopruner_species_files[160, ]phylopruner_species_files[76, ]phylopruner_species_files[90, ]phylopruner_species_files[188, ]# 5.3 - Comparing LDDT and ALNTMSCORE with iQtree gene trees distances#LDDTgetwd()lddt_trees_analysis <- read.table("lddt_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(lddt_trees_analysis$V1, iqtree_treefiles_analysis$V1,      main = "Distance between accepted Metazoa tree and inferred gene trees",      xlab = "LDDT gene trees (wRF)",      ylab = "IQ-TREE best ML gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(lddt_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(lddt_trees_analysis))summary(lddt_trees_analysis)summary(iqtree_treefiles_analysis)#ALNTMSCOREalntmscore_trees_analysis <- read.table("alntmscore_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(alntmscore_trees_analysis$V1, iqtree_treefiles_analysis$V1, main = "Distance between accepted Metazoa tree and inferred gene trees", xlab = "ALNTMSCORE gene trees (wRF)", ylab = "IQ-TREE best ML gene trees (wRF)",abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(alntmscore_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(alntmscore_trees_analysis))summary(alntmscore_trees_analysis)summary(iqtree_treefiles_analysis)# 5.4 - COMPARING LDDT AND ALNTMSCORE TO FOLDTREE#Foldtree on y, lddt on xplot(lddt_trees_analysis$V1, foldtree_trees_analysis$V1,      main = "Distance between FoldTree Metazoa tree and LDDT gene trees",      xlab = "LDDT gene trees (wRF)",      ylab = "FoldTree gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(lddt_trees_analysis$V1,foldtree_trees_analysis$V1, labels = rownames(lddt_trees_analysis))summary(lddt_trees_analysis)summary(foldtree_trees_analysis)#FoldTree on y, alntmscore on xplot(alntmscore_trees_analysis$V1, foldtree_trees_analysis$V1,      main = "Distance between FoldTree Metazoa tree and ALNTMSCORE gene trees",      xlab = "ALNTMSCORE gene trees (wRF)",      ylab = "FoldTree gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(alntmscore_trees_analysis$V1,foldtree_trees_analysis$V1, labels = rownames(alntmscore_trees_analysis))summary(alntmscore_trees_analysis)  #alntmscore is almost as different as it can possibly be to the iqtree sequence, with the lddt being even less different and the foldtree being the  # least different. evidence:      #124*2 = 248 --bcs of robinson folds n-2 and then 2 splits      #max(iqtree_treefiles_analysis$V1) = 209.17      #max(foldtree_trees_analysis$V1) = 240.39      #max(lddt_trees_analysis$V1) = 244.12      #max(alntmscore_trees_analysis$V1) = 245.54#UNPAIRED T-TESTS  #un-paired bcs the inputs are diff (the trees are based on diff algorithms)  #confidence level 0.95, p value 0.05#Iq-tree against foldtreet.test(iqtree_treefiles_analysis$V1, foldtree_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of foldtree.     # mean of iqtree distances = 152.2854    # mean of foldtree distances = 178.9976     #mean difference: #Iq-tree against lddtt.test(iqtree_treefiles_analysis$V1, lddt_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of lddt.  mean difference: -71.20433  # mean of iqtree distances = 152.2854  # mean of lddt distances = 223.4898  #mean difference:#Iq-tree against alntmscoret.test(iqtree_treefiles_analysis$V1, alntmscore_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of alntmscore. mean difference: -84.53345.  # mean of iqtree distances = 152.2854  # mean of alntmscore distances = 236.8189  #mean difference:#Foldtree against lddtt.test(foldtree_trees_analysis$V1, lddt_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of foldtree is significantly # smaller (and therefore better) than the average distance of lddt mean difference: -44.49217.  # mean of foldtree distances = 178.9976  # mean of lddt distances = 223.4898  #mean difference:#Foldtree against alntmscoret.test(foldtree_trees_analysis$V1, alntmscore_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of foldtree is significantly # smaller (and therefore better) than the average distance of alntmscore mean difference: -57.82128.   # mean of foldtree distances = 178.9976  # mean of alntmscore distances = 236.8189  #mean difference:# 5.5 - Comparing sequence length and distance#Iqtree graph alignment_lengths_iqtree <- read.table("length_alignments_iqtree.txt", header = FALSE)plot(alignment_lengths_iqtree$V1, iqtree_treefiles_analysis$V1, main = "Comparing protein sequence length with distance   between IQ-TREE gene trees and accepted Metazoa tree", xlab = "Alignment length", ylab = "IQ-TREE best ML gene trees (wRF)",   ylim=c(50, 250), pch = 20)model <- lm(iqtree_treefiles_analysis$V1 ~ alignment_lengths_iqtree$V1)abline(model, col = "black")min(alignment_lengths_iqtree)min(iqtree_treefiles_analysis)max(alignment_lengths_iqtree)max(iqtree_treefiles_analysis)#Correlation testcor.test(x = alignment_lengths_iqtree$V1, y = iqtree_treefiles_analysis$V1, method = "pearson")cor.test(x = alignment_lengths_iqtree$V1[-c(144)], y = iqtree_treefiles_analysis$V1[-c(144)], method = "pearson")#FOLDTREE sequence_lengths <- read.table("sequence_lengths_list_final.txt", header = FALSE)plot(sequence_lengths$V1, foldtree_trees_analysis$V1, main = "Comparing protein sequence length with distance   between FoldTree gene trees and accepted Metazoa tree", xlab = "Sequence length", ylab = "FoldTree gene trees (wRF)",   ylim=c(50, 250), pch = 20)model <- lm(foldtree_trees_analysis$V1 ~ sequence_lengths$V1)abline(model, col = "black")cor.test(x = sequence_lengths$V1, y = foldtree_trees_analysis$V1, method = "pearson")# excluding outliercor.test(x = sequence_lengths$V1[-c(144)], y = foldtree_trees_analysis$V1[-c(144)], method = "pearson")# 5.6 - Comparing species numbers and distanceshead(phylopypruner_species_table)plot(x = phylopypruner_species_table$V2, y = iqtree_treefiles_analysis$V1, main = "Comparing number of species per orthogroup   with distance between IQ-TREE gene trees and accepted Metazoa tree", xlab = "Number of species",   ylab = "IQ-TREE best ML gene trees (wRF)", ylim=c(50, 250), pch = 20)model <- lm(iqtree_treefiles_analysis$V1 ~ phylopypruner_species_table$V2)abline(model, col = "black")cor.test(x = phylopypruner_species_table$V2, y = iqtree_treefiles_analysis$V1, method = "pearson")# excluding outlier cor.test(x = phylopypruner_species_table$V2[-c(144)], y = iqtree_treefiles_analysis$V1[-c(144)], method = "pearson")head(phylopypruner_species_table)plot(x = phylopypruner_species_table$V2, y = foldtree_trees_analysis$V1, main = "Comparing number of species per orthogroup   with distance between FoldTree gene trees and accepted Metazoa tree", xlab = "Number of species",   ylab = "FoldTree gene trees (wRF)", ylim=c(50, 250), pch = 20)model <- lm(foldtree_trees_analysis$V1 ~ phylopypruner_species_table$V2)abline(model, col = "black")cor.test(x = phylopypruner_species_table$V2, y = foldtree_trees_analysis$V1, method = "pearson")# excluding outliercor.test(x = phylopypruner_species_table$V2[-c(144)], y = foldtree_trees_analysis$V1[-c(144)], method = "pearson")