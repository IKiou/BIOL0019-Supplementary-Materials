# ANALYSIS OF RESULTS#1 - COMPARING NUMBER OF SPECIES BEFORE AND AFTER PHYLOPYPRUNER#Reading in the two tablescover70_species_table <- read.table("70_cover_species_table.txt", header = FALSE)phylopypruner_species_table <- read.table("phylopypruner_species_table.txt", header = FALSE)shared <- cover70_species_table[as.factor(phylopypruner_species_table$V1),]shared[c(5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,142,143,144,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,199,200,201,202,203),2] - 
phylopypruner_species_table[c(5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,142,143,144,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,199,200,201,202,203),2]

#2 - Comparing FoldTree and iQtree gene trees distancesfoldtree_trees_analysis <- read.table("foldtree_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)rownames(foldtree_trees_analysis) <- c(1:203)iqtree_treefiles_analysis <- read.table("iqtree_treefiles_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(foldtree_trees_analysis$V1, iqtree_treefiles_analysis$V1,      main = "Distance between accepted Metazoa tree and inferred gene trees",      xlab = "FoldTree gene trees (wRF)",      ylab = "IQ-TREE best ML gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(foldtree_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(foldtree_trees_analysis))#axis(side = c(1,2), at = c(0,50,100,150,200), labels = seq(50,250,50))summary(foldtree_trees_analysis)summary(iqtree_treefiles_analysis)which(foldtree_trees_analysis$V1 == min(foldtree_trees_analysis))phylopruner_species_files <- read.table("phylopypruner_species_files.txt", header = FALSE)which(foldtree_trees_analysis$V1 > iqtree_treefiles_analysis$V1)which(as.integer(foldtree_trees_analysis$V1) == as.integer(iqtree_treefiles_analysis$V1))phylopruner_species_files[18, ]phylopruner_species_files[60, ]phylopruner_species_files[148, ]phylopruner_species_files[192, ]which(iqtree_treefiles_analysis$V1 > foldtree_trees_analysis$V1)phylopruner_species_files[14, ]phylopruner_species_files[31, ]phylopruner_species_files[35, ]phylopruner_species_files[42, ]phylopruner_species_files[48, ]phylopruner_species_files[50, ]phylopruner_species_files[56, ]phylopruner_species_files[71, ]phylopruner_species_files[81, ]phylopruner_species_files[106, ]phylopruner_species_files[113, ]phylopruner_species_files[122, ]phylopruner_species_files[129, ]phylopruner_species_files[168, ]phylopruner_species_files[189, ]phylopruner_species_files[203, ]which(foldtree_trees_analysis$V1 == max(foldtree_trees_analysis))phylopruner_species_files[160, ]phylopruner_species_files[76, ]phylopruner_species_files[90, ]phylopruner_species_files[188, ]#3 - DO SAME FOR SAME Y AXIS AND CHANGE X AXIS TO LDDT AND ALNTMSCORE#LDDTgetwd()lddt_trees_analysis <- read.table("lddt_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(lddt_trees_analysis$V1, iqtree_treefiles_analysis$V1,      main = "Distance between accepted Metazoa tree and inferred gene trees",      xlab = "LDDT gene trees (wRF)",      ylab = "IQ-TREE best ML gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(lddt_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(lddt_trees_analysis))summary(lddt_trees_analysis)summary(iqtree_treefiles_analysis)#ALNTMSCOREalntmscore_trees_analysis <- read.table("alntmscore_trees_analysis.tree_weightedRFMatrix.txt", header = FALSE, skip =1)plot(alntmscore_trees_analysis$V1, iqtree_treefiles_analysis$V1, main = "Distance between accepted Metazoa tree and inferred gene trees", xlab = "ALNTMSCORE gene trees (wRF)", ylab = "IQ-TREE best ML gene trees (wRF)",abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(alntmscore_trees_analysis$V1,iqtree_treefiles_analysis$V1, labels = rownames(alntmscore_trees_analysis))summary(alntmscore_trees_analysis)summary(iqtree_treefiles_analysis)#4 - NOW COMPARING LDDT AND ALNTMSCORE TO FOLDTREE#Foldtree on y, lddt on xplot(lddt_trees_analysis$V1, foldtree_trees_analysis$V1,      main = "Distance between FoldTree Metazoa tree and LDDT gene trees",      xlab = "LDDT gene trees (wRF)",      ylab = "FoldTree gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(lddt_trees_analysis$V1,foldtree_trees_analysis$V1, labels = rownames(lddt_trees_analysis))summary(lddt_trees_analysis)summary(foldtree_trees_analysis)#FoldTree on y, alntmscore on xplot(alntmscore_trees_analysis$V1, foldtree_trees_analysis$V1,      main = "Distance between FoldTree Metazoa tree and ALNTMSCORE gene trees",      xlab = "ALNTMSCORE gene trees (wRF)",      ylab = "FoldTree gene trees (wRF)",     abline(a=0, b=1), xlim=c(50, 250), ylim=c(50, 250), pch = 20)text(alntmscore_trees_analysis$V1,foldtree_trees_analysis$V1, labels = rownames(alntmscore_trees_analysis))summary(alntmscore_trees_analysis)  #alntmscore is almost as different as it can possibly be to the iqtree sequence, with the lddt being even less different and the foldtree being the  # least different. evidence:      #124*2 = 248 --bcs of robinson folds n-2 and then 2 splits      #max(iqtree_treefiles_analysis$V1) = 209.17      #max(foldtree_trees_analysis$V1) = 240.39      #max(lddt_trees_analysis$V1) = 244.12      #max(alntmscore_trees_analysis$V1) = 245.54#5 - UNPAIRED T-TEST  #un-paired bcs the inputs are diff (the trees are based on diff algorithms)  #confidence level 0.95, p value 0.05#Iq-tree against foldtreet.test(iqtree_treefiles_analysis$V1, foldtree_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of foldtree.     # mean of iqtree distances = 152.2854    # mean of foldtree distances = 178.9976     #mean difference: #Iq-tree against lddtt.test(iqtree_treefiles_analysis$V1, lddt_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of lddt.  mean difference: -71.20433  # mean of iqtree distances = 152.2854  # mean of lddt distances = 223.4898  #mean difference:#Iq-tree against alntmscoret.test(iqtree_treefiles_analysis$V1, alntmscore_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of iqtree is significantly # smaller (and therefore better) than the average distance of alntmscore. mean difference: -84.53345.  # mean of iqtree distances = 152.2854  # mean of alntmscore distances = 236.8189  #mean difference:#Foldtree against lddtt.test(foldtree_trees_analysis$V1, lddt_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of foldtree is significantly # smaller (and therefore better) than the average distance of lddt mean difference: -44.49217.  # mean of foldtree distances = 178.9976  # mean of lddt distances = 223.4898  #mean difference:#Foldtree against alntmscoret.test(foldtree_trees_analysis$V1, alntmscore_trees_analysis$V1, alternative = c("less"), paired = FALSE)# p value smaller than critical value 0.05 (2.2e-16), so the average distance of foldtree is significantly # smaller (and therefore better) than the average distance of alntmscore mean difference: -57.82128.   # mean of foldtree distances = 178.9976  # mean of alntmscore distances = 236.8189  #mean difference:#6 - NEXT GRAPH: Comparing sequence length and distance#Iqtree graph alignment_lengths_iqtree <- read.table("length_alignments_iqtree.txt", header = FALSE)plot(alignment_lengths_iqtree$V1, iqtree_treefiles_analysis$V1, main = "Comparing protein sequence length with distance   between IQ-TREE gene trees and accepted Metazoa tree", xlab = "Alignment length", ylab = "IQ-TREE best ML gene trees (wRF)",   ylim=c(50, 250), pch = 20)model <- lm(iqtree_treefiles_analysis$V1 ~ alignment_lengths_iqtree$V1)abline(model, col = "black")min(alignment_lengths_iqtree)min(iqtree_treefiles_analysis)max(alignment_lengths_iqtree)max(iqtree_treefiles_analysis)#Correlation testcor.test(x = alignment_lengths_iqtree$V1, y = iqtree_treefiles_analysis$V1, method = "pearson")cor.test(x = alignment_lengths_iqtree$V1[-c(144)], y = iqtree_treefiles_analysis$V1[-c(144)], method = "pearson")#FOLDTREE sequence_lengths <- read.table("sequence_lengths_list_final.txt", header = FALSE)plot(sequence_lengths$V1, foldtree_trees_analysis$V1, main = "Comparing protein sequence length with distance   between FoldTree gene trees and accepted Metazoa tree", xlab = "Sequence length", ylab = "FoldTree gene trees (wRF)",   ylim=c(50, 250), pch = 20)model <- lm(foldtree_trees_analysis$V1 ~ sequence_lengths$V1)abline(model, col = "black")cor.test(x = sequence_lengths$V1, y = foldtree_trees_analysis$V1, method = "pearson")# excluding outliercor.test(x = sequence_lengths$V1[-c(144)], y = foldtree_trees_analysis$V1[-c(144)], method = "pearson")# 7 - NEXT GRAPH: Comparing SPECIES NUMBERS and DISTANCEShead(phylopypruner_species_table)plot(x = phylopypruner_species_table$V2, y = iqtree_treefiles_analysis$V1, main = "Comparing number of species per orthogroup   with distance between IQ-TREE gene trees and accepted Metazoa tree", xlab = "Number of species",   ylab = "IQ-TREE best ML gene trees (wRF)", ylim=c(50, 250), pch = 20)model <- lm(iqtree_treefiles_analysis$V1 ~ phylopypruner_species_table$V2)abline(model, col = "black")cor.test(x = phylopypruner_species_table$V2, y = iqtree_treefiles_analysis$V1, method = "pearson")# excluding outlier cor.test(x = phylopypruner_species_table$V2[-c(144)], y = iqtree_treefiles_analysis$V1[-c(144)], method = "pearson")head(phylopypruner_species_table)plot(x = phylopypruner_species_table$V2, y = foldtree_trees_analysis$V1, main = "Comparing number of species per orthogroup   with distance between FoldTree gene trees and accepted Metazoa tree", xlab = "Number of species",   ylab = "FoldTree gene trees (wRF)", ylim=c(50, 250), pch = 20)model <- lm(foldtree_trees_analysis$V1 ~ phylopypruner_species_table$V2)abline(model, col = "black")cor.test(x = phylopypruner_species_table$V2, y = foldtree_trees_analysis$V1, method = "pearson")# excluding outliercor.test(x = phylopypruner_species_table$V2[-c(144)], y = foldtree_trees_analysis$V1[-c(144)], method = "pearson")